# Документация WS

[COLAB](https://colab.research.google.com/drive/1jMotXHMlDuTtfvCMHPIRXu1-M03aKxr6?usp=sharing)

Необходимо было произвести нахождение ям на дорогах, согласно датасету, состоящему из 6 тысяч изображений. Суммарный вес датасета – 23 гигабайта. Отношение классов: 3 : 7

Для работы с изображениями реализованы ImageFolder и PotImage классы, позволяющие удобным образом хранить данные о картинках и аннотациях. 

Далее были взяты данные датасета 1 и обозначены соответственно 0 и 1 (0 — для не-ям, 1 — для ям). Этот датафрейм был разделён на обучающих и тестировочный. 

Изображения загружаются с помощью keras preprocessing и нормализуются (не 0-255, а 0-1). batch_size выбран средний — 32. Архитектура ИНС выбрана VGG16, но для ускорения значительно уменьшено кол-во слоёв и кол-во фильтров. 

```jsx
Model: "sequential_2"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 conv2d_23 (Conv2D)          (None, 244, 244, 8)       224       
                                                                 
 max_pooling2d_10 (MaxPoolin  (None, 122, 122, 8)      0         
 g2D)                                                            
                                                                 
 conv2d_24 (Conv2D)          (None, 122, 122, 16)      1168      
                                                                 
 max_pooling2d_11 (MaxPoolin  (None, 61, 61, 16)       0         
 g2D)                                                            
                                                                 
 conv2d_25 (Conv2D)          (None, 61, 61, 32)        4640      
                                                                 
 max_pooling2d_12 (MaxPoolin  (None, 30, 30, 32)       0         
 g2D)                                                            
                                                                 
 conv2d_26 (Conv2D)          (None, 30, 30, 64)        18496     
                                                                 
 max_pooling2d_13 (MaxPoolin  (None, 15, 15, 64)       0         
 g2D)                                                            
                                                                 
 flatten_2 (Flatten)         (None, 14400)             0         
                                                                 
 dense_6 (Dense)             (None, 64)                921664    
                                                                 
 dense_7 (Dense)             (None, 64)                4160      
                                                                 
 dense_8 (Dense)             (None, 1)                 65        
                                                                 
=================================================================
Total params: 950,417
Trainable params: 950,417
Non-trainable params: 0
```

Обученную модель можно увидеть в [vgg16_1.h5](https://github.com/Leamich/WorldSkillsCompetition/blob/main/vgg16_1.h5). Итоговая точность — **0.84.** 

Также реализован метод для удобного предсказания одного изображения `predict_image(path)`.